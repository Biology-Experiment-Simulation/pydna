
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pydna.dseq &#8212; Pydna 3.0.1+2.g47ae1f65a3.dirty documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Pydna 3.0.1+2.g47ae1f65a3.dirty documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../pydna.html" accesskey="U">pydna</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pydna.dseq</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># Copyright 2013-2018 by Bj√∂rn Johansson.  All rights reserved.</span>
<span class="c1"># This code is part of the Python-dna distribution and governed by its</span>
<span class="c1"># license.  Please see the LICENSE.txt file that should have been included</span>
<span class="c1"># as part of this package.</span>
<span class="sd">&#39;&#39;&#39;Provides the Dseq class for handling double stranded DNA sequences. </span>
<span class="sd">Dseq is a subclass of :class:`Bio.Seq.Seq`. The Dseq class</span>
<span class="sd">is mostly useful as a part of the :class:`pydna.dseqrecord.Dseqrecord` class which</span>
<span class="sd">can hold more meta data.</span>

<span class="sd">The Dseq class support the notion of circular and linear DNA topology.&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="k">import</span> <span class="n">Iterable</span> <span class="k">as</span> <span class="n">_Iterable</span>

<span class="kn">import</span> <span class="nn">copy</span>                 <span class="k">as</span> <span class="nn">_copy</span>
<span class="kn">import</span> <span class="nn">itertools</span>            <span class="k">as</span> <span class="nn">_itertools</span>

<span class="kn">import</span> <span class="nn">sys</span>                  <span class="k">as</span> <span class="nn">_sys</span>
<span class="kn">import</span> <span class="nn">math</span>                 <span class="k">as</span> <span class="nn">_math</span>

<span class="kn">from</span> <span class="nn">Bio.Alphabet.IUPAC</span>     <span class="k">import</span> <span class="n">IUPACAmbiguousDNA</span> <span class="k">as</span> <span class="n">_IUPACAmbiguousDNA</span>
<span class="kn">from</span> <span class="nn">Bio.Seq</span>                <span class="k">import</span> <span class="n">Seq</span>               <span class="k">as</span> <span class="n">_Seq</span>

<span class="kn">from</span> <span class="nn">pydna._pretty</span> <span class="k">import</span> <span class="n">pretty_str</span> <span class="k">as</span> <span class="n">_pretty_str</span>
<span class="kn">from</span> <span class="nn">pydna.utils</span>  <span class="k">import</span> <span class="n">seguid</span>      <span class="k">as</span> <span class="n">_seg</span>
<span class="kn">from</span> <span class="nn">pydna.utils</span>  <span class="k">import</span> <span class="n">rc</span>          <span class="k">as</span> <span class="n">_rc</span>
<span class="kn">from</span> <span class="nn">pydna.utils</span>  <span class="k">import</span> <span class="n">complement</span>  <span class="k">as</span> <span class="n">_complement</span>
<span class="kn">from</span> <span class="nn">pydna.utils</span>  <span class="k">import</span> <span class="n">flatten</span>     <span class="k">as</span> <span class="n">_flatten</span>
<span class="kn">from</span> <span class="nn">pydna.common_sub_strings</span> <span class="k">import</span> <span class="n">common_sub_strings</span> <span class="k">as</span> <span class="n">_common_sub_strings</span>

<span class="kn">from</span> <span class="nn">Bio.Restriction</span> <span class="k">import</span> <span class="n">RestrictionBatch</span> <span class="k">as</span> <span class="n">_RestrictionBatch</span>
<span class="kn">from</span> <span class="nn">Bio.Restriction</span> <span class="k">import</span> <span class="n">CommOnly</span>


<div class="viewcode-block" id="Dseq"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq">[docs]</a><span class="k">class</span> <span class="nc">Dseq</span><span class="p">(</span><span class="n">_Seq</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Dseq is a class designed to hold information for a double stranded</span>
<span class="sd">    DNA fragment. Dseq also holds information describing the topology of</span>
<span class="sd">    the DNA fragment (linear or circular).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>

<span class="sd">    watson : str</span>
<span class="sd">        a string representing the watson (sense) DNA strand.</span>

<span class="sd">    crick : str, optional</span>
<span class="sd">        a string representing the crick (antisense) DNA strand.</span>

<span class="sd">    ovhg : int, optional</span>
<span class="sd">        A positive or negative number to describe the stagger between the watson and crick strands.</span>
<span class="sd">        see below for a detailed explanation.</span>

<span class="sd">    linear : bool, optional</span>
<span class="sd">        True indicates that sequence is linear, False that it is circular.</span>

<span class="sd">    circular : bool, optional</span>
<span class="sd">        True indicates that sequence is circular, False that it is linear.</span>

<span class="sd">    alphabet : Bio.Alphabet, optional</span>
<span class="sd">        Bio.Alphabet.IUPAC.IUPACAmbiguousDNA from the Biopython package is set as default.</span>


<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    Dseq is a subclass of the Biopython Seq object. It stores two</span>
<span class="sd">    strings representing the watson (sense) and crick(antisense) strands.</span>
<span class="sd">    two properties called linear and circular, and a numeric value ovhg</span>
<span class="sd">    (overhang) describing the stagger for the watson and crick strand</span>
<span class="sd">    in the 5&#39; end of the fragment.</span>

<span class="sd">    The most common usage is probably to create a Dseq object as a</span>
<span class="sd">    part of a Dseqrecord object (see :class:`pydna.dseqrecord.Dseqrecord`).</span>

<span class="sd">    There are three ways of creating a Dseq object directly:</span>

<span class="sd">    Only one argument (string):</span>

<span class="sd">    &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;)</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>

<span class="sd">    The given string will be interpreted as the watson strand of a</span>
<span class="sd">    blunt, linear double stranded sequence object. The crick strand</span>
<span class="sd">    is created automatically from the watson strand.</span>

<span class="sd">    Two arguments (string, string):</span>

<span class="sd">    &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;gggaaat&quot;,&quot;ttt&quot;)</span>
<span class="sd">    Dseq(-7)</span>
<span class="sd">    gggaaat</span>
<span class="sd">       ttt</span>

<span class="sd">    If both watson and crick are given, but not ovhg an attempt</span>
<span class="sd">    will be made to find the best annealing between the strands.</span>
<span class="sd">    There are limitations to this! For long fragments it is quite</span>
<span class="sd">    slow. The length of the annealing sequences have to be at least</span>
<span class="sd">    half the length of the shortest of the strands.</span>

<span class="sd">    Three arguments (string, string, ovhg=int):</span>

<span class="sd">    The ovhg parameter controls the stagger at the five prime end::</span>

<span class="sd">        ovhg = -2</span>

<span class="sd">        XXXXX</span>
<span class="sd">          XXX</span>

<span class="sd">        ovhg = -1</span>

<span class="sd">        XXXXX</span>
<span class="sd">         XXXX</span>

<span class="sd">        ovhg = 0</span>

<span class="sd">        XXXXX</span>
<span class="sd">        XXXXX</span>

<span class="sd">        ovhg = 1</span>

<span class="sd">         XXXX</span>
<span class="sd">        XXXXX</span>

<span class="sd">        ovhg = 2</span>

<span class="sd">          XXX</span>
<span class="sd">        XXXXX                          </span>

<span class="sd">    Example of creating Dseq objects with different amounts of stagger:</span>

<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=-2)</span>
<span class="sd">    Dseq(-7)</span>
<span class="sd">    agt</span>
<span class="sd">      attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=-1)</span>
<span class="sd">    Dseq(-6)</span>
<span class="sd">    agt</span>
<span class="sd">     attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=0)</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">    agt</span>
<span class="sd">    attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=1)</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">     agt</span>
<span class="sd">    attca</span>
<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=2)</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">      agt</span>
<span class="sd">    attca</span>

<span class="sd">    If the ovhg parameter is specified a crick strand also needs to be supplied,</span>
<span class="sd">    otherwise an exception is raised.</span>

<span class="sd">    &gt;&gt;&gt; Dseq(watson=&quot;agt&quot;,ovhg=2)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">      File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">      File &quot;/usr/local/lib/python2.7/dist-packages/pydna_/dsdna.py&quot;, line 169, in __init__</span>
<span class="sd">        else:</span>
<span class="sd">    ValueError: ovhg defined without crick strand!</span>


<span class="sd">    The default alphabet is set to Biopython IUPACAmbiguousDNA</span>

<span class="sd">    The shape of the fragment is set by either:</span>

<span class="sd">    1. linear   = False, True</span>
<span class="sd">    2. circular = True, False</span>

<span class="sd">    Note that both ends of the DNA fragment has to be compatible to set</span>
<span class="sd">    circular = True (or linear = False).</span>


<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;)</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;,ovhg=0)</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;,ovhg=1)</span>
<span class="sd">    Dseq(-4)</span>
<span class="sd">     aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;,&quot;ttt&quot;,ovhg=-1)</span>
<span class="sd">    Dseq(-4)</span>
<span class="sd">    aaa</span>
<span class="sd">     ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;, &quot;ttt&quot;, linear = False ,ovhg=0)</span>
<span class="sd">    Dseq(o3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>
<span class="sd">    &gt;&gt;&gt; Dseq(&quot;aaa&quot;, &quot;ttt&quot;, circular = True , ovhg=0)</span>
<span class="sd">    Dseq(o3)</span>
<span class="sd">    aaa</span>
<span class="sd">    ttt</span>

<span class="sd">    &gt;&gt;&gt; a=Dseq(&quot;tttcccc&quot;,&quot;aaacccc&quot;)</span>
<span class="sd">    &gt;&gt;&gt; a</span>
<span class="sd">    Dseq(-11)</span>
<span class="sd">        tttcccc</span>
<span class="sd">    ccccaaa</span>
<span class="sd">    &gt;&gt;&gt; a.ovhg</span>
<span class="sd">    4</span>
<span class="sd">    </span>
<span class="sd">    &gt;&gt;&gt; b=Dseq(&quot;ccccttt&quot;,&quot;ccccaaa&quot;)</span>
<span class="sd">    &gt;&gt;&gt; b</span>
<span class="sd">    Dseq(-11)</span>
<span class="sd">    ccccttt</span>
<span class="sd">        aaacccc</span>
<span class="sd">    &gt;&gt;&gt; b.ovhg</span>
<span class="sd">    -4</span>
<span class="sd">    &gt;&gt;&gt;   </span>

<span class="sd">    Coercing to string</span>

<span class="sd">    &gt;&gt;&gt; str(a)</span>
<span class="sd">    &#39;ggggtttcccc&#39;</span>

<span class="sd">    A Dseq object can be longer that either the watson or crick strands.</span>

<span class="sd">    ::</span>

<span class="sd">        &lt;-- length --&gt;</span>
<span class="sd">        GATCCTTT</span>
<span class="sd">             AAAGCCTAG</span>

<span class="sd">        &lt;-- length --&gt;</span>
<span class="sd">              GATCCTTT</span>
<span class="sd">        AAAGCCCTA</span>

<span class="sd">    The slicing of a linear Dseq object works mostly as it does for a string.</span>

<span class="sd">    &gt;&gt;&gt; s=&quot;ggatcc&quot;</span>
<span class="sd">    &gt;&gt;&gt; s[2:3]</span>
<span class="sd">    &#39;a&#39;</span>
<span class="sd">    &gt;&gt;&gt; s[2:4]</span>
<span class="sd">    &#39;at&#39;</span>
<span class="sd">    &gt;&gt;&gt; s[2:4:-1]</span>
<span class="sd">    &#39;&#39;</span>
<span class="sd">    &gt;&gt;&gt; s[::2]</span>
<span class="sd">    &#39;gac&#39;</span>
<span class="sd">    &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">    &gt;&gt;&gt; d=Dseq(s, linear=True)</span>
<span class="sd">    &gt;&gt;&gt; d[2:3]</span>
<span class="sd">    Dseq(-1)</span>
<span class="sd">    a</span>
<span class="sd">    t</span>
<span class="sd">    &gt;&gt;&gt; d[2:4]</span>
<span class="sd">    Dseq(-2)</span>
<span class="sd">    at</span>
<span class="sd">    ta</span>
<span class="sd">    &gt;&gt;&gt; d[2:4:-1]</span>
<span class="sd">    Dseq(-0)</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    &lt;BLANKLINE&gt;</span>
<span class="sd">    &gt;&gt;&gt; d[::2]</span>
<span class="sd">    Dseq(-3)</span>
<span class="sd">    gac</span>
<span class="sd">    ctg</span>


<span class="sd">    The slicing of a circular Dseq object has a slightly different meaning.</span>


<span class="sd">    &gt;&gt;&gt; s=&quot;ggAtCc&quot;</span>
<span class="sd">    &gt;&gt;&gt; d=Dseq(s, circular=True)</span>
<span class="sd">    &gt;&gt;&gt; d</span>
<span class="sd">    Dseq(o6)</span>
<span class="sd">    ggAtCc</span>
<span class="sd">    ccTaGg</span>
<span class="sd">    &gt;&gt;&gt; d[4:3]</span>
<span class="sd">    Dseq(-5)</span>
<span class="sd">    CcggA</span>
<span class="sd">    GgccT</span>


<span class="sd">    The slice [X:X] produces an empty slice for a string, while this will return</span>
<span class="sd">    the linearized sequence starting at X:</span>

<span class="sd">    &gt;&gt;&gt; s=&quot;ggatcc&quot;</span>
<span class="sd">    &gt;&gt;&gt; d=Dseq(s, circular=True)</span>
<span class="sd">    &gt;&gt;&gt; d</span>
<span class="sd">    Dseq(o6)</span>
<span class="sd">    ggatcc</span>
<span class="sd">    cctagg</span>
<span class="sd">    &gt;&gt;&gt; d[3:3]</span>
<span class="sd">    Dseq(-6)</span>
<span class="sd">    tccgga</span>
<span class="sd">    aggcct</span>
<span class="sd">    &gt;&gt;&gt;</span>


<span class="sd">    See also</span>
<span class="sd">    --------</span>
<span class="sd">    pydna.dseqrecord.Dseqrecord</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span>
                  <span class="n">watson</span><span class="p">,</span>
                  <span class="n">crick</span>         <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">ovhg</span>          <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">linear</span>        <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">circular</span>      <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">pos</span>           <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="n">alphabet</span>      <span class="o">=</span> <span class="n">_IUPACAmbiguousDNA</span><span class="p">()</span> <span class="p">):</span>

        <span class="k">if</span> <span class="n">crick</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ovhg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">crick</span> <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
                <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">watson</span>     
            <span class="k">else</span><span class="p">:</span> <span class="c1"># ovhg given, but no crick strand</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;ovhg defined without crick strand!&quot;</span><span class="p">)</span>                
        <span class="k">else</span><span class="p">:</span> <span class="c1"># crick strand given</span>
            <span class="k">if</span> <span class="n">ovhg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># ovhg not given</span>

                <span class="n">olaps</span> <span class="o">=</span> <span class="n">_common_sub_strings</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
                                            <span class="nb">str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()),</span>
                                            <span class="nb">int</span><span class="p">(</span><span class="n">_math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">))</span><span class="o">/</span><span class="n">_math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">4</span><span class="p">)))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">F</span><span class="p">,</span><span class="n">T</span><span class="p">,</span><span class="n">L</span> <span class="o">=</span> <span class="n">olaps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Could not anneal the two strands. Please provide ovhg value&quot;</span><span class="p">)</span>
                <span class="n">ovhgs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ol</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">ol</span> <span class="ow">in</span> <span class="n">olaps</span> <span class="k">if</span> <span class="n">ol</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">L</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ovhgs</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;More than one way of annealing the strands. Please provide ovhg value&quot;</span><span class="p">)</span>
                <span class="n">ovhg</span> <span class="o">=</span> <span class="n">T</span><span class="o">-</span><span class="n">F</span>
                
                <span class="n">sns</span> <span class="o">=</span> <span class="p">((</span><span class="n">ovhg</span><span class="o">*</span><span class="s2">&quot; &quot;</span><span class="p">)</span>  <span class="o">+</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">watson</span><span class="p">))</span>
                <span class="n">asn</span> <span class="o">=</span> <span class="p">((</span><span class="o">-</span><span class="n">ovhg</span><span class="o">*</span><span class="s2">&quot; &quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">)))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="ow">or</span> <span class="n">b</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="ow">in</span> <span class="n">_itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="n">sns</span><span class="p">,</span><span class="n">asn</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">)])</span>

            <span class="k">else</span><span class="p">:</span> <span class="c1"># ovhg given             </span>
                <span class="k">if</span> <span class="n">ovhg</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>                    
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">watson</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">watson</span>                    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">watson</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)])</span>                   
                <span class="k">elif</span> <span class="n">ovhg</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>                       
                    <span class="k">if</span> <span class="n">ovhg</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">):</span>                            
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="n">ovhg</span><span class="p">:])</span><span class="o">+</span><span class="n">watson</span>                            
                    <span class="k">else</span><span class="p">:</span>                            
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="n">ovhg</span><span class="p">:])</span> <span class="o">+</span> <span class="n">watson</span> <span class="o">+</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="n">ovhg</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)])</span>
                <span class="k">else</span><span class="p">:</span> <span class="c1"># ovhg &lt; 0</span>
                    <span class="k">if</span> <span class="o">-</span><span class="n">ovhg</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">watson</span><span class="o">+</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="n">ovhg</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)])</span>                            
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">watson</span>
                        
        <span class="bp">self</span><span class="o">.</span><span class="n">_circular</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">circular</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">bool</span><span class="p">(</span><span class="n">linear</span><span class="p">)</span><span class="o">^</span><span class="nb">bool</span><span class="p">(</span><span class="n">circular</span><span class="p">)</span> <span class="ow">or</span> <span class="n">linear</span><span class="o">==</span><span class="kc">False</span> <span class="ow">and</span> <span class="n">circular</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_linear</span>   <span class="o">=</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_circular</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crick</span>  <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span>
        <span class="c1">#self.length = max(len(watson)+max(0,ovhg), len(crick)+max(0,-ovhg))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>  <span class="o">=</span> <span class="n">ovhg</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>    <span class="o">=</span> <span class="n">pos</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>
        

<div class="viewcode-block" id="Dseq.quick"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.quick">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">quick</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">watson</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">crick</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">alphabet</span><span class="o">=</span><span class="n">_IUPACAmbiguousDNA</span><span class="p">()):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># Does not call __init__</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">crick</span>  <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_ovhg</span>  <span class="o">=</span> <span class="n">ovhg</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_linear</span> <span class="o">=</span> <span class="n">linear</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">length</span>  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ovhg</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">+</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="n">ovhg</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">pos</span>      <span class="o">=</span> <span class="n">pos</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">alphabet</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_data</span>  <span class="o">=</span> <span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ovhg</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">):])</span><span class="o">+</span><span class="n">watson</span><span class="o">+</span><span class="n">_rc</span><span class="p">(</span><span class="n">crick</span><span class="p">[:</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="n">ovhg</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">))])</span>
        <span class="k">return</span> <span class="n">obj</span></div>

<div class="viewcode-block" id="Dseq.from_string"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.from_string">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">dna</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">linear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>  <span class="c1"># Does not call __init__</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">watson</span> <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">crick</span>  <span class="o">=</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">dna</span><span class="p">))</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_ovhg</span>  <span class="o">=</span> <span class="mi">0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_circular</span> <span class="o">=</span> <span class="n">circular</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_linear</span> <span class="o">=</span> <span class="n">linear</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">length</span>  <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dna</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">pos</span>      <span class="o">=</span> <span class="mi">0</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">alphabet</span> <span class="o">=</span> <span class="n">_IUPACAmbiguousDNA</span><span class="p">()</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">_data</span>  <span class="o">=</span> <span class="n">dna</span>
        <span class="k">return</span> <span class="n">obj</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ovhg</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The ovhg property. This cannot be set directly, but is a </span>
<span class="sd">        consequence of how the watson and crick strands anneal to </span>
<span class="sd">        each other&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">linear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The linear property can not be set directly. </span>
<span class="sd">        Use an empty slice [:] to create a linear object.&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_linear</span>


    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">circular</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;The circular property can not be set directly. </span>
<span class="sd">        Use :meth:`looped` to create a circular Dseq object&#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_circular</span>


<div class="viewcode-block" id="Dseq.mw"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.mw">[docs]</a>    <span class="k">def</span> <span class="nf">mw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method returns the molecular weight of the DNA molecule</span>
<span class="sd">        in g/mol. The following formula is used::</span>
<span class="sd">           </span>
<span class="sd">               MW = (A x 313.2) + (T x 304.2) + </span>
<span class="sd">                    (C x 289.2) + (G x 329.2) + </span>
<span class="sd">                    (N x 308.9) + 79.0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nts</span> <span class="o">=</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span> <span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
       
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span> <span class="p">[</span><span class="mf">313.2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nts</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s2">&quot;a&quot;</span><span class="p">]</span> <span class="o">+</span>
                    <span class="p">[</span><span class="mf">304.2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nts</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">+</span>
                    <span class="p">[</span><span class="mf">289.2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nts</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s2">&quot;c&quot;</span><span class="p">]</span> <span class="o">+</span>
                    <span class="p">[</span><span class="mf">329.2</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nts</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s2">&quot;g&quot;</span><span class="p">]</span> <span class="o">+</span>
                    <span class="p">[</span><span class="mf">308.9</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nts</span> <span class="k">if</span> <span class="n">n</span><span class="o">==</span><span class="s2">&quot;n&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="mi">79</span></div>


<div class="viewcode-block" id="Dseq.find"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.find">[docs]</a>    <span class="k">def</span> <span class="nf">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">_sys</span><span class="o">.</span><span class="n">maxsize</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This method behaves like the python string method of the same name.</span>

<span class="sd">        Returns an integer, the index of the first occurrence of substring</span>
<span class="sd">        argument sub in the (sub)sequence given by [start:end].</span>

<span class="sd">        Returns -1 if the subsequence is NOT found.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        sub : string or Seq object</span>
<span class="sd">            a string or another Seq object to look for.</span>

<span class="sd">        start : int, optional</span>
<span class="sd">            slice start.</span>

<span class="sd">        end : int, optional</span>
<span class="sd">            slice end.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; seq = Dseq(&quot;atcgactgacgtgtt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; seq</span>
<span class="sd">        Dseq(-15)</span>
<span class="sd">        atcgactgacgtgtt</span>
<span class="sd">        tagctgactgcacaa</span>
<span class="sd">        &gt;&gt;&gt; seq.find(&quot;gac&quot;)</span>
<span class="sd">        3</span>
<span class="sd">        &gt;&gt;&gt; seq = Dseq(watson=&quot;agt&quot;,crick=&quot;actta&quot;,ovhg=-2)</span>
<span class="sd">        &gt;&gt;&gt; seq</span>
<span class="sd">        Dseq(-7)</span>
<span class="sd">        agt</span>
<span class="sd">          attca</span>
<span class="sd">        &gt;&gt;&gt; seq.find(&quot;taa&quot;)</span>
<span class="sd">        2</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_Seq</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sub</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>

        <span class="n">sub_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_seq_str_and_check_alphabet</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">_pretty_str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">+</span><span class="n">_pretty_str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">sub_str</span><span class="p">,</span> <span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sl</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a subsequence. This method is used by the slice notation&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="n">sns</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">*</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)[</span><span class="n">sl</span><span class="p">]</span>
            <span class="n">asn</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">*</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])[</span><span class="n">sl</span><span class="p">]</span>
            <span class="n">ovhg</span> <span class="o">=</span> <span class="nb">max</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()),</span>
                        <span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">asn</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">asn</span><span class="o">.</span><span class="n">lstrip</span><span class="p">())),</span>
                        <span class="n">key</span><span class="o">=</span><span class="nb">abs</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">asn</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">ovhg</span><span class="o">=</span><span class="n">ovhg</span><span class="p">,</span> <span class="n">linear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sl</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">start</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="n">sl</span><span class="o">.</span><span class="n">stop</span>  <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                       <span class="n">sl</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sl</span><span class="o">.</span><span class="n">start</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sl</span><span class="o">.</span><span class="n">stop</span><span class="o">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">sl</span><span class="o">.</span><span class="n">start</span><span class="o">&lt;</span><span class="n">sl</span><span class="o">.</span><span class="n">stop</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">sl</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">sl</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">stp</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sl</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                    <span class="n">stp</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">start</span><span class="o">=</span><span class="n">sl</span><span class="o">.</span><span class="n">start</span>
                <span class="n">stop</span><span class="o">=</span><span class="n">sl</span><span class="o">.</span><span class="n">stop</span>

                <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[(</span><span class="n">start</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">))::</span><span class="n">stp</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:(</span><span class="n">stop</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">):</span><span class="n">stp</span><span class="p">]</span>
                <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-</span><span class="n">stop</span><span class="p">::</span><span class="n">stp</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-</span><span class="n">start</span><span class="p">:</span><span class="n">stp</span><span class="p">]</span>

                <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">linear</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Compare to another Dseq object OR an object that implements</span>
<span class="sd">        watson, crick and ovhg properties. This comparison is case</span>
<span class="sd">        insensitive.</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">same</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span>
                    <span class="n">other</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>  <span class="ow">and</span>
                    <span class="n">other</span><span class="o">.</span><span class="n">ovhg</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">circular</span><span class="p">)</span>
                    <span class="c1"># Also test for alphabet ?</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">same</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">same</span>


    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a representation of the sequence, truncated if</span>
<span class="sd">        longer than 30 bp&#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">:</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">hej</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
                    <span class="n">d</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">a</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">*</span><span class="s2">&quot; &quot;</span>

            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">)]</span>
                <span class="n">hej</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
                    <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">d</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="s2">&quot; &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">d</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">hej</span><span class="o">=</span><span class="mi">0</span>

            <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">:]</span>
                <span class="n">y</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">f</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">c</span><span class="p">)</span><span class="o">*</span><span class="s2">&quot; &quot;</span>
            <span class="k">elif</span> <span class="n">x</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">f</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="n">x</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">y</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">c</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">*</span><span class="s2">&quot; &quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">c</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">f</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="n">y</span><span class="o">=</span><span class="mi">0</span>

            <span class="n">L</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-</span><span class="n">hej</span><span class="o">-</span><span class="n">y</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">)</span>
            <span class="n">x2</span> <span class="o">=</span> <span class="n">x1</span><span class="o">+</span><span class="n">L</span>
            <span class="n">x3</span> <span class="o">=</span> <span class="o">-</span><span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">x4</span> <span class="o">=</span> <span class="n">x3</span><span class="o">+</span><span class="n">L</span>

            <span class="n">b</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">x1</span><span class="p">:</span><span class="n">x2</span><span class="p">]</span>
            <span class="n">e</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="n">x3</span><span class="p">:</span><span class="n">x4</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>
                <span class="n">b</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">b</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>
                <span class="n">e</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">..</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">e</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:])</span>

            <span class="k">return</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{klass}</span><span class="s2">(</span><span class="si">{top}{size}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
                               <span class="s2">&quot;</span><span class="si">{a}{b}{c}</span><span class="se">\n</span><span class="s2">&quot;</span>
                               <span class="s2">&quot;</span><span class="si">{d}{e}{f}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">klass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                                   <span class="n">top</span> <span class="o">=</span> <span class="p">{</span><span class="kc">True</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span><span class="s2">&quot;o&quot;</span><span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">],</span>
                                                   <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                                   <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span>
                                                   <span class="n">b</span><span class="o">=</span><span class="n">b</span><span class="p">,</span>
                                                   <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span>
                                                   <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">,</span>
                                                   <span class="n">e</span><span class="o">=</span><span class="n">e</span><span class="p">,</span>
                                                   <span class="n">f</span><span class="o">=</span><span class="n">f</span><span class="p">,)</span>


        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">(</span><span class="si">{}{}</span><span class="s2">)</span><span class="se">\n</span><span class="si">{}</span><span class="se">\n</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                                        <span class="p">{</span><span class="kc">True</span><span class="p">:</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span><span class="s2">&quot;o&quot;</span><span class="p">}[</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">],</span>
                                                        <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span>
                                                        <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">*</span><span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span>
                                                        <span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">*</span><span class="s2">&quot; &quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>


<div class="viewcode-block" id="Dseq.reverse_complement"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.reverse_complement">[docs]</a>    <span class="k">def</span> <span class="nf">reverse_complement</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a Dseq object where watson and crick have switched</span>
<span class="sd">        places. This represents the same double stranded sequence.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;catcgatc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; b=a.reverse_complement()</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        gatcgatg</span>
<span class="sd">        ctagctac</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">       &#39;&#39;&#39;</span>
        <span class="n">ovhg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span> <span class="n">ovhg</span><span class="o">=</span><span class="n">ovhg</span><span class="p">,</span> <span class="n">linear</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">,</span> <span class="n">circular</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">)</span></div>


    <span class="n">rc</span> <span class="o">=</span> <span class="n">reverse_complement</span> <span class="c1"># alias for reverse_complement</span>

    
<div class="viewcode-block" id="Dseq.shifted"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.shifted">[docs]</a>    <span class="k">def</span> <span class="nf">shifted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shift</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a shifted version of a circular Dseq object.&#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DNA is not circular.&quot;</span><span class="p">)</span>
        <span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">shift</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>   
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">shift</span><span class="p">:]</span><span class="o">+</span><span class="bp">self</span><span class="p">[:</span><span class="n">shift</span><span class="p">])</span><span class="o">.</span><span class="n">looped</span><span class="p">()</span></div>
        

<div class="viewcode-block" id="Dseq.looped"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.looped">[docs]</a>    <span class="k">def</span> <span class="nf">looped</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a circularized Dseq object. This can only be done if the</span>
<span class="sd">        two ends are compatible, otherwise a TypeError is raised.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;catcgatc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; a.looped()</span>
<span class="sd">        Dseq(o8)</span>
<span class="sd">        catcgatc</span>
<span class="sd">        gtagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;t&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcgat</span>
<span class="sd">         tagctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;t&quot;).looped()</span>
<span class="sd">        Dseq(o7)</span>
<span class="sd">        catcgat</span>
<span class="sd">        gtagcta</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;a&quot;)</span>
<span class="sd">        Dseq(-8)</span>
<span class="sd">        catcga</span>
<span class="sd">          agctag</span>
<span class="sd">        &gt;&gt;&gt; a.T4(&quot;a&quot;).looped()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span>
<span class="sd">          File &quot;/usr/local/lib/python2.7/dist-packages/pydna/dsdna.py&quot;, line 357, in looped</span>
<span class="sd">            if type5 == type3 and str(sticky5) == str(rc(sticky3)):</span>
<span class="sd">        TypeError: DNA cannot be circularized.</span>
<span class="sd">        5&#39; and 3&#39; sticky ends not compatible!</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">       &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">type5</span><span class="p">,</span> <span class="n">sticky5</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>
        <span class="n">type3</span><span class="p">,</span> <span class="n">sticky3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">type5</span> <span class="o">==</span> <span class="n">type3</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">sticky5</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">sticky3</span><span class="p">)):</span>
            <span class="n">nseq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">],</span> <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">linear</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">circular</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nseq</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">nseq</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">nseq</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DNA cannot be circularized.</span><span class="se">\n</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;5&#39; and 3&#39; sticky ends not compatible!&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Dseq.tolinear"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.tolinear">[docs]</a>    <span class="k">def</span> <span class="nf">tolinear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># pragma: no cover</span>
        <span class="sd">&#39;&#39;&#39;Returns a blunt, linear copy of a circular Dseq object. This can</span>
<span class="sd">       only be done if the Dseq object is circular, otherwise a</span>
<span class="sd">       TypeError is raised.</span>
<span class="sd">       </span>
<span class="sd">       This method is deprecated, use slicing instead. See example below.</span>

<span class="sd">       Examples</span>
<span class="sd">       --------</span>

<span class="sd">       &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">       &gt;&gt;&gt; a=Dseq(&quot;catcgatc&quot;, circular=True)</span>
<span class="sd">       &gt;&gt;&gt; a</span>
<span class="sd">       Dseq(o8)</span>
<span class="sd">       catcgatc</span>
<span class="sd">       gtagctag</span>
<span class="sd">       &gt;&gt;&gt; a[:]</span>
<span class="sd">       Dseq(-8)</span>
<span class="sd">       catcgatc</span>
<span class="sd">       gtagctag</span>
<span class="sd">       &gt;&gt;&gt;</span>

<span class="sd">       &#39;&#39;&#39;</span>
        <span class="kn">import</span> <span class="nn">warnings</span> <span class="k">as</span> <span class="nn">_warnings</span>
        <span class="kn">from</span> <span class="nn">pydna</span> <span class="k">import</span> <span class="n">_PydnaDeprecationWarning</span>
        <span class="n">_warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;tolinear method is obsolete; &quot;</span>
                       <span class="s2">&quot;please use obj[:] &quot;</span>
                       <span class="s2">&quot;instead of obj.tolinear().&quot;</span><span class="p">,</span>
                       <span class="n">_PydnaDeprecationWarning</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;DNA is not circular.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">selfcopy</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">selfcopy</span><span class="o">.</span><span class="n">_linear</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">selfcopy</span><span class="o">.</span><span class="n">_circular</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">selfcopy</span><span class="c1"># self.__class__(self.watson, linear=True)</span></div>
        

<div class="viewcode-block" id="Dseq.five_prime_end"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.five_prime_end">[docs]</a>    <span class="k">def</span> <span class="nf">five_prime_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a tuple describing the structure of the 5&#39; end of</span>
<span class="sd">        the DNA fragment</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.five_prime_end()</span>
<span class="sd">        (&#39;blunt&#39;, &#39;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">         aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.five_prime_end()</span>
<span class="sd">        (&quot;3&#39;&quot;, &#39;t&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=-1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">        aaa</span>
<span class="sd">         ttt</span>
<span class="sd">        &gt;&gt;&gt; a.five_prime_end()</span>
<span class="sd">        (&quot;5&#39;&quot;, &#39;a&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pydna.dseq.Dseq.three_prime_end</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;3&#39;&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;5&#39;&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;3&#39;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;blunt&quot;</span>
        <span class="k">return</span> <span class="n">type_</span><span class="p">,</span> <span class="n">sticky</span></div>


<div class="viewcode-block" id="Dseq.three_prime_end"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.three_prime_end">[docs]</a>    <span class="k">def</span> <span class="nf">three_prime_end</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a tuple describing the structure of the 5&#39; end of</span>
<span class="sd">        the DNA fragment</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.three_prime_end()</span>
<span class="sd">        (&#39;blunt&#39;, &#39;&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">         aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.three_prime_end()</span>
<span class="sd">        (&quot;3&#39;&quot;, &#39;a&#39;)</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;, ovhg=-1)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-4)</span>
<span class="sd">        aaa</span>
<span class="sd">         ttt</span>
<span class="sd">        &gt;&gt;&gt; a.three_prime_end()</span>
<span class="sd">        (&quot;5&#39;&quot;, &#39;t&#39;)</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        See also</span>
<span class="sd">        --------</span>
<span class="sd">        pydna.dseq.Dseq.five_prime_end</span>

<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">ovhg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>

        <span class="k">if</span> <span class="n">ovhg</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="n">ovhg</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;5&#39;&quot;</span>
        <span class="k">elif</span> <span class="n">ovhg</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="o">-</span><span class="n">ovhg</span><span class="p">:]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;3&#39;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sticky</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">type_</span> <span class="o">=</span> <span class="s2">&quot;blunt&quot;</span>
        <span class="k">return</span> <span class="n">type_</span><span class="p">,</span> <span class="n">sticky</span></div>


    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Simulates ligation between two DNA fragments.</span>

<span class="sd">        Add other Dseq object at the end of the sequence.</span>
<span class="sd">        Type error is raised if any of the points below are fulfilled:</span>

<span class="sd">        * one or more objects are circular</span>
<span class="sd">        * if three prime sticky end of self is not the same type</span>
<span class="sd">          (5&#39; or 3&#39;) as the sticky end of other</span>
<span class="sd">        * three prime sticky end of self complementary with five</span>
<span class="sd">          prime sticky end of other.</span>

<span class="sd">        Phosphorylation and dephosphorylation is not considered.</span>
<span class="sd">        </span>
<span class="sd">        DNA is allways presumed to have the necessary 5&#39; phospate</span>
<span class="sd">        group necessary for ligation.</span>

<span class="sd">       &#39;&#39;&#39;</span>
        <span class="c1"># test for circular DNA</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;circular DNA cannot be ligated!&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">circular</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;circular DNA cannot be ligated!&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="n">self_type</span><span class="p">,</span>  <span class="n">self_tail</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="n">other_type</span><span class="p">,</span> <span class="n">other_tail</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">self_type</span> <span class="o">==</span> <span class="n">other_type</span> <span class="ow">and</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">self_tail</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">_rc</span><span class="p">(</span><span class="n">other_tail</span><span class="p">))):</span>
            
            <span class="n">answer</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">quick</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="n">other</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span>
                                <span class="n">other</span><span class="o">.</span><span class="n">crick</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">other</span><span class="p">:</span>
            <span class="n">answer</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;sticky ends not compatible!&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">answer</span>


    <span class="k">def</span> <span class="nf">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;TypeError: can&#39;t multiply Dseq by non-int of type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">number</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">number</span><span class="o">&lt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">_copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">new</span> <span class="o">+=</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">new</span>


    <span class="k">def</span> <span class="nf">_fill_in_five_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="p">):</span>
        <span class="n">stuffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">_rc</span><span class="p">(</span><span class="n">se</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                    <span class="n">stuffer</span><span class="o">+=</span><span class="n">n</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="o">+</span><span class="n">stuffer</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">+</span><span class="nb">len</span><span class="p">(</span><span class="n">stuffer</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_fill_in_three_prime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="p">):</span>
        <span class="n">stuffer</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">_rc</span><span class="p">(</span><span class="n">se</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                    <span class="n">stuffer</span><span class="o">+=</span><span class="n">n</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="o">+</span><span class="n">stuffer</span>


<div class="viewcode-block" id="Dseq.fill_in"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.fill_in">[docs]</a>    <span class="k">def</span> <span class="nf">fill_in</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Fill in of five prime protruding end with a DNA polymerase</span>
<span class="sd">        that has only DNA polymerase activity (such as exo-klenow [#]_)</span>
<span class="sd">        and any combination of A, G, C or T. Default are all four</span>
<span class="sd">        nucleotides together.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        nucleotides : str</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; a=Dseq(&quot;aaa&quot;, &quot;ttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; a</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; a.fill_in()</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; b=Dseq(&quot;caaa&quot;, &quot;cttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaa</span>
<span class="sd">         tttc</span>
<span class="sd">        &gt;&gt;&gt; b.fill_in()</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaag</span>
<span class="sd">        gtttc</span>
<span class="sd">        &gt;&gt;&gt; b.fill_in(&quot;g&quot;)</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaag</span>
<span class="sd">        gtttc</span>
<span class="sd">        &gt;&gt;&gt; b.fill_in(&quot;tac&quot;)</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaa</span>
<span class="sd">         tttc</span>
<span class="sd">        &gt;&gt;&gt; c=Dseq(&quot;aaac&quot;, &quot;tttg&quot;)</span>
<span class="sd">        &gt;&gt;&gt; c</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">         aaac</span>
<span class="sd">        gttt</span>
<span class="sd">        &gt;&gt;&gt; c.fill_in()</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">         aaac</span>
<span class="sd">        gttt</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        References</span>
<span class="sd">        ----------</span>
<span class="sd">        .. [#] http://en.wikipedia.org/wiki/Klenow_fragment#The_exo-_Klenow_fragment</span>

<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nucleotides</span><span class="p">:</span>
            <span class="n">nucleotides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">letters</span>
        <span class="n">nucleotides</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nucleotides</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">+</span><span class="n">nucleotides</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_five_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_three_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span></div>


<div class="viewcode-block" id="Dseq.mung"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.mung">[docs]</a>    <span class="k">def</span> <span class="nf">mung</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Simulates treatment a nuclease with 5&#39;-3&#39; and 3&#39;-5&#39; single</span>
<span class="sd">       strand specific exonuclease activity (such as mung bean nuclease [#]_)</span>

<span class="sd">       ::</span>

<span class="sd">            ggatcc    -&gt;     gatcc</span>
<span class="sd">             ctaggg          ctagg</span>

<span class="sd">             ggatcc   -&gt;      ggatc</span>
<span class="sd">            tcctag            cctag</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; b=Dseq(&quot;caaa&quot;, &quot;cttt&quot;)</span>
<span class="sd">        &gt;&gt;&gt; b</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        caaa</span>
<span class="sd">         tttc</span>
<span class="sd">        &gt;&gt;&gt; b.mung()</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>
<span class="sd">        &gt;&gt;&gt; c=Dseq(&quot;aaac&quot;, &quot;tttg&quot;)</span>
<span class="sd">        &gt;&gt;&gt; c</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">         aaac</span>
<span class="sd">        gttt</span>
<span class="sd">        &gt;&gt;&gt; c.mung()</span>
<span class="sd">        Dseq(-3)</span>
<span class="sd">        aaa</span>
<span class="sd">        ttt</span>



<span class="sd">       References</span>
<span class="sd">       ----------</span>
<span class="sd">       .. [#] http://en.wikipedia.org/wiki/Mung_bean_nuclease</span>


<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">):</span><span class="nb">min</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)])</span></div>


<div class="viewcode-block" id="Dseq.T4"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.T4">[docs]</a>    <span class="k">def</span> <span class="nf">T4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nucleotides</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Fill in five prime protruding ends and chewing back</span>
<span class="sd">       three prime protruding ends by a DNA polymerase providing both</span>
<span class="sd">       5&#39;-3&#39; DNA polymerase activity and 3&#39;-5&#39; nuclease acitivty</span>
<span class="sd">       (such as T4 DNA polymerase). This can be done in presence of any</span>
<span class="sd">       combination of the four A, G, C or T. Removing one or more nucleotides</span>
<span class="sd">       can facilitate engineering of sticky ends. Default are all four nucleotides together.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       nucleotides : str</span>


<span class="sd">       Examples</span>
<span class="sd">       --------</span>

<span class="sd">       &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">       &gt;&gt;&gt; a=Dseq(&quot;gatcgatc&quot;)</span>
<span class="sd">       &gt;&gt;&gt; a</span>
<span class="sd">       Dseq(-8)</span>
<span class="sd">       gatcgatc</span>
<span class="sd">       ctagctag</span>
<span class="sd">       &gt;&gt;&gt; a.T4()</span>
<span class="sd">       Dseq(-8)</span>
<span class="sd">       gatcgatc</span>
<span class="sd">       ctagctag</span>
<span class="sd">       &gt;&gt;&gt; a.T4(&quot;t&quot;)</span>
<span class="sd">       Dseq(-8)</span>
<span class="sd">       gatcgat</span>
<span class="sd">        tagctag</span>
<span class="sd">       &gt;&gt;&gt; a.T4(&quot;a&quot;)</span>
<span class="sd">       Dseq(-8)</span>
<span class="sd">       gatcga</span>
<span class="sd">         agctag</span>
<span class="sd">       &gt;&gt;&gt; a.T4(&quot;g&quot;)</span>
<span class="sd">       Dseq(-8)</span>
<span class="sd">       gatcg</span>
<span class="sd">          gctag</span>
<span class="sd">       &gt;&gt;&gt;</span>

<span class="sd">       &#39;&#39;&#39;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nucleotides</span><span class="p">:</span> 
            <span class="n">nucleotides</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alphabet</span><span class="o">.</span><span class="n">letters</span>
        <span class="n">nucleotides</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">nucleotides</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="n">nucleotides</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">five_prime_end</span><span class="p">()</span>        
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_five_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;3&#39;&quot;</span><span class="p">:</span>
                <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">crick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ovhg</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">crick</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">crick</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">x</span><span class="o">-=</span><span class="mi">1</span>
        <span class="n">ovhg</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">crick</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="o">+</span><span class="n">ovhg</span>
        <span class="n">crick</span> <span class="o">=</span> <span class="n">crick</span><span class="p">[:</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">crick</span><span class="p">:</span> 
            <span class="n">ovhg</span><span class="o">=</span><span class="mi">0</span>
        <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span>
        <span class="nb">type</span><span class="p">,</span> <span class="n">se</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">three_prime_end</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;5&#39;&quot;</span><span class="p">:</span>
            <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fill_in_three_prime</span><span class="p">(</span><span class="n">nucleotides</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span> <span class="o">==</span> <span class="s2">&quot;3&#39;&quot;</span><span class="p">:</span>
                <span class="n">watson</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)]</span>
        <span class="n">x</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">watson</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">x</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">watson</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nucleotides</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">x</span><span class="o">-=</span><span class="mi">1</span>
        <span class="n">watson</span><span class="o">=</span><span class="n">watson</span><span class="p">[:</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">Dseq</span><span class="p">(</span><span class="n">watson</span><span class="p">,</span> <span class="n">crick</span><span class="p">,</span> <span class="n">ovhg</span><span class="p">)</span></div>


    <span class="n">t4</span> <span class="o">=</span> <span class="n">T4</span> <span class="c1"># alias for the T4 method.</span>

    
<div class="viewcode-block" id="Dseq.no_cutters"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.no_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">no_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the enzymes in a RestrictionBatch that do **not** </span>
<span class="sd">        cut the sequence.&quot;&quot;&quot;</span>
        <span class="n">ana</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ncut</span> <span class="o">=</span> <span class="p">{</span><span class="n">enz</span><span class="p">:</span><span class="n">sitelist</span> <span class="k">for</span> <span class="p">(</span><span class="n">enz</span><span class="p">,</span><span class="n">sitelist</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ana</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">sitelist</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">_RestrictionBatch</span><span class="p">(</span><span class="n">ncut</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Dseq.unique_cutters"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.unique_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">unique_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the enzymes in a RestrictionBatch that cut the sequence </span>
<span class="sd">        exactly once.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cutters</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">)</span> </div>
    
    
    <span class="n">once_cutters</span> <span class="o">=</span> <span class="n">unique_cutters</span> <span class="c1"># alias for unique_cutters</span>
    
    
<div class="viewcode-block" id="Dseq.twice_cutters"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.twice_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">twice_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the enzymes in a RestrictionBatch that cut the sequence </span>
<span class="sd">        exactly twice.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_cutters</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">batch</span><span class="o">=</span><span class="n">batch</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Dseq.n_cutters"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.n_cutters">[docs]</a>    <span class="k">def</span> <span class="nf">n_cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the enzymes in a RestrictionBatch that cut the sequence </span>
<span class="sd">        n times.&quot;&quot;&quot;</span>
        <span class="n">ana</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ncut</span> <span class="o">=</span> <span class="p">{</span><span class="n">enz</span><span class="p">:</span><span class="n">sitelist</span> <span class="k">for</span> <span class="p">(</span><span class="n">enz</span><span class="p">,</span><span class="n">sitelist</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ana</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sitelist</span><span class="p">)</span><span class="o">==</span><span class="n">n</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">_RestrictionBatch</span><span class="p">(</span><span class="n">ncut</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Dseq.cutters"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.cutters">[docs]</a>    <span class="k">def</span> <span class="nf">cutters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span> <span class="o">=</span> <span class="n">CommOnly</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the enzymes in a RestrictionBatch that cut the sequence </span>
<span class="sd">        at least once.&quot;&quot;&quot;</span>
        <span class="n">ana</span> <span class="o">=</span> <span class="n">batch</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">ncut</span> <span class="o">=</span> <span class="p">{</span><span class="n">enz</span><span class="p">:</span><span class="n">sitelist</span> <span class="k">for</span> <span class="p">(</span><span class="n">enz</span><span class="p">,</span><span class="n">sitelist</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ana</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">sitelist</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">_RestrictionBatch</span><span class="p">(</span><span class="n">ncut</span><span class="p">)</span></div>


<div class="viewcode-block" id="Dseq.seguid"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.seguid">[docs]</a>    <span class="k">def</span> <span class="nf">seguid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the SEGUID for the Dseq. The definition </span>
<span class="sd">        varies with the amount of stagger between the sequences.&quot;&quot;&quot;</span>
        <span class="n">rc_ovhg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">==</span><span class="n">rc_ovhg</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_seg</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">&lt;</span><span class="n">rc_ovhg</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span>
            <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">&gt;</span><span class="n">rc_ovhg</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span>
            <span class="n">c</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span>
            <span class="n">o</span> <span class="o">=</span> <span class="n">rc_ovhg</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span><span class="o">==</span><span class="n">rc_ovhg</span><span class="p">:</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">))</span>
            <span class="n">o</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ovhg</span>
        <span class="k">return</span> <span class="n">_seg</span><span class="p">(</span> <span class="n">_pretty_str</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="o">+</span> <span class="n">w</span> <span class="o">+</span> <span class="s2">&quot;|&quot;</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span></div>


<div class="viewcode-block" id="Dseq.cut"><a class="viewcode-back" href="../../index.html#pydna.dseq.Dseq.cut">[docs]</a>    <span class="k">def</span> <span class="nf">cut</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">enzymes</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Returns a list of linear Dseq fragments produced in the digestion.</span>
<span class="sd">        If there are no cuts, an empty list is returned.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>

<span class="sd">        enzymes : enzyme object or iterable of such objects</span>
<span class="sd">            A Bio.Restriction.XXX restriction objects or iterable.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        frags : list</span>
<span class="sd">            list of Dseq objects formed by the digestion</span>


<span class="sd">        Examples</span>
<span class="sd">        --------</span>

<span class="sd">        &gt;&gt;&gt; from pydna.dseq import Dseq</span>
<span class="sd">        &gt;&gt;&gt; seq=Dseq(&quot;ggatccnnngaattc&quot;)</span>
<span class="sd">        &gt;&gt;&gt; seq</span>
<span class="sd">        Dseq(-15)</span>
<span class="sd">        ggatccnnngaattc</span>
<span class="sd">        cctaggnnncttaag</span>
<span class="sd">        &gt;&gt;&gt; from Bio.Restriction import BamHI,EcoRI</span>
<span class="sd">        &gt;&gt;&gt; type(seq.cut(BamHI))</span>
<span class="sd">        &lt;class &#39;tuple&#39;&gt;</span>
<span class="sd">        &gt;&gt;&gt; for frag in seq.cut(BamHI): print(repr(frag))</span>
<span class="sd">        Dseq(-5)</span>
<span class="sd">        g</span>
<span class="sd">        cctag</span>
<span class="sd">        Dseq(-14)</span>
<span class="sd">        gatccnnngaattc</span>
<span class="sd">            gnnncttaag</span>
<span class="sd">        &gt;&gt;&gt; seq.cut(EcoRI, BamHI) ==  seq.cut(BamHI, EcoRI)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; a,b,c = seq.cut(EcoRI, BamHI)</span>
<span class="sd">        &gt;&gt;&gt; a+b+c</span>
<span class="sd">        Dseq(-15)</span>
<span class="sd">        ggatccnnngaattc</span>
<span class="sd">        cctaggnnncttaag</span>
<span class="sd">        &gt;&gt;&gt;</span>

<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="n">pad</span> <span class="o">=</span> <span class="s2">&quot;n&quot;</span><span class="o">*</span><span class="mi">50</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="n">dsseq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mung</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dsseq</span> <span class="o">=</span> <span class="n">Dseq</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">,</span><span class="n">linear</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">circular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">enzymes</span><span class="p">)</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">enzymes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;intersection&quot;</span><span class="p">):</span> <span class="c1"># RestrictionBatch</span>
            <span class="n">enzymecuts</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="c1">#cuts = e.search(dsseq+dsseq[:e.size-1] if self.circular else dsseq)</span>
                <span class="n">cuts</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">_Seq</span><span class="p">(</span><span class="n">pad</span><span class="o">+</span><span class="n">dsseq</span><span class="o">.</span><span class="n">watson</span><span class="o">+</span><span class="n">dsseq</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="n">e</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">pad</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="k">else</span> <span class="n">dsseq</span><span class="p">)</span>
                <span class="n">enzymecuts</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">cuts</span><span class="p">,</span> <span class="n">e</span><span class="p">))</span>
            <span class="n">enzymecuts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">enzymes</span><span class="o">=</span><span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">e</span><span class="p">)</span> <span class="ow">in</span> <span class="n">enzymecuts</span> <span class="k">if</span> <span class="n">c</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">enzymes</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">_flatten</span><span class="p">(</span><span class="n">enzymes</span><span class="p">)))</span> <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">_Seq</span><span class="p">(</span><span class="n">pad</span><span class="o">+</span><span class="n">dsseq</span><span class="o">.</span><span class="n">watson</span><span class="o">+</span><span class="n">dsseq</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="n">e</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">pad</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">circular</span> <span class="k">else</span> <span class="n">dsseq</span><span class="p">)]</span>   <span class="c1"># flatten</span>
        
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">enzymes</span><span class="p">:</span> <span class="k">return</span> <span class="p">()</span>

        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">:</span>
            <span class="n">frags</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span>    
        <span class="k">else</span><span class="p">:</span>
            <span class="n">l</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">:</span>
                <span class="n">wpos</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">pad</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">_Seq</span><span class="p">(</span><span class="n">pad</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">watson</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="n">e</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">pad</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">cpos</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="nb">len</span><span class="p">(</span><span class="n">pad</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">e</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">_Seq</span><span class="p">(</span><span class="n">pad</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">crick</span>  <span class="o">+</span>  <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="n">e</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">pad</span><span class="p">)][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

                <span class="k">for</span> <span class="n">w</span><span class="p">,</span><span class="n">c</span> <span class="ow">in</span> <span class="n">_itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">wpos</span><span class="p">,</span> <span class="n">cpos</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">w</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="n">c</span> <span class="o">+</span> <span class="n">e</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span><span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                        <span class="n">frags</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Dseq</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">w</span><span class="o">%</span><span class="n">l</span><span class="p">:]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="n">w</span><span class="o">%</span><span class="n">l</span><span class="p">],</span> 
                                        <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="n">c</span><span class="o">%</span><span class="n">l</span><span class="p">:]</span>  <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">crick</span><span class="p">[:</span><span class="n">c</span><span class="o">%</span><span class="n">l</span><span class="p">],</span> 
                                        <span class="n">ovhg</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span> 
                                        <span class="n">pos</span><span class="o">=</span><span class="n">w</span><span class="p">)</span> <span class="p">]</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="n">frags</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">newfrags</span><span class="o">=</span><span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">enz</span> <span class="ow">in</span> <span class="n">enzymes</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">frag</span> <span class="ow">in</span> <span class="n">frags</span><span class="p">:</span>           
                
                <span class="n">ws</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">enz</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">_Seq</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">watson</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;N&quot;</span><span class="p">)]</span>                
                <span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">enz</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">_Seq</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">crick</span> <span class="p">)</span><span class="o">+</span><span class="s2">&quot;N&quot;</span><span class="p">)]</span>

                <span class="n">sitepairs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">sw</span><span class="p">,</span> <span class="n">sc</span><span class="p">)</span> <span class="k">for</span> <span class="n">sw</span><span class="p">,</span> <span class="n">sc</span> <span class="ow">in</span> <span class="n">_itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span><span class="n">cs</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                             <span class="k">if</span> <span class="p">(</span><span class="n">sw</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">frag</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span> <span class="o">-</span>
                             <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">enz</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span>
                             <span class="o">==</span>
                             <span class="nb">len</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">crick</span><span class="p">)</span><span class="o">-</span><span class="n">sc</span> <span class="o">-</span>
                             <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">frag</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)</span> <span class="o">+</span>
                             <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">enz</span><span class="o">.</span><span class="n">ovhg</span><span class="p">))]</span>
                

                <span class="n">sitepairs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">length</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>

                <span class="n">w2</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <span class="n">sitepairs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            
                <span class="n">newfrags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dseq</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">watson</span><span class="p">[:</span><span class="n">w2</span><span class="p">],</span>
                                     <span class="n">frag</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="n">c1</span><span class="p">:],</span> 
                                     <span class="n">ovhg</span><span class="o">=</span><span class="n">frag</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span> 
                                     <span class="n">pos</span><span class="o">=</span><span class="n">frag</span><span class="o">.</span><span class="n">pos</span><span class="p">))</span>

                <span class="k">for</span> <span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">c2</span><span class="p">),</span> <span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">c1</span><span class="p">)</span>  <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sitepairs</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sitepairs</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                    <span class="n">newfrags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Dseq</span><span class="p">(</span><span class="n">frag</span><span class="o">.</span><span class="n">watson</span><span class="p">[</span><span class="n">w1</span><span class="p">:</span><span class="n">w2</span><span class="p">],</span> 
                                         <span class="n">frag</span><span class="o">.</span><span class="n">crick</span><span class="p">[</span><span class="n">c1</span><span class="p">:</span><span class="n">c2</span><span class="p">],</span> 
                                         <span class="n">ovhg</span> <span class="o">=</span> <span class="n">enz</span><span class="o">.</span><span class="n">ovhg</span><span class="p">,</span> 
                                         <span class="n">pos</span><span class="o">=</span> <span class="n">frag</span><span class="o">.</span><span class="n">pos</span> <span class="o">+</span> <span class="n">w1</span><span class="o">-</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">enz</span><span class="o">.</span><span class="n">ovhg</span><span class="p">)))</span>

            <span class="n">frags</span><span class="o">=</span><span class="n">newfrags</span>
            <span class="n">newfrags</span><span class="o">=</span><span class="p">[]</span>

        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">frags</span><span class="p">)</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span><span class="o">==</span><span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">os</span> <span class="k">as</span> <span class="nn">_os</span>
    <span class="n">cached</span> <span class="o">=</span> <span class="n">_os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;pydna_cached_funcs&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">_os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;pydna_cached_funcs&quot;</span><span class="p">]</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">optionflags</span><span class="o">=</span><span class="n">doctest</span><span class="o">.</span><span class="n">ELLIPSIS</span><span class="p">)</span>
    <span class="n">_os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;pydna_cached_funcs&quot;</span><span class="p">]</span><span class="o">=</span><span class="n">cached</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">Pydna 3.0.1+2.g47ae1f65a3.dirty documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../pydna.html" >pydna</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2013-2019, Bj√∂rn Johansson.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>